<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>로그인 - 여기저기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <link rel="stylesheet" href="styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#000',
                        accent: '#FF385C',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 h-screen flex items-center justify-center p-6">

    <div class="w-full max-w-md bg-white rounded-3xl shadow-xl p-8 md:p-10 animate-fade-in relative">
        
        <a href="index.html" class="absolute top-6 right-6 text-gray-400 hover:text-black">
            <i data-lucide="x" width="24"></i>
        </a>

        <div class="text-center mb-10">
            <h1 class="text-3xl font-black mb-2 tracking-tight">여기저기</h1>
            <p class="text-gray-500">나만의 여행 큐레이션을 시작해보세요.</p>
        </div>

        <div class="space-y-4">
            <button id="btn-google" class="w-full py-3.5 px-4 rounded-xl border border-gray-200 flex items-center justify-center gap-3 hover:bg-gray-50 transition-colors relative">
                <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="Google" class="w-5 h-5" />
                <span class="font-bold text-gray-700">Google로 시작하기</span>
            </button>

            <button id="btn-kakao" class="w-full py-3.5 px-4 rounded-xl bg-[#FEE500] flex items-center justify-center gap-3 hover:bg-[#FDD835] transition-colors">
                <div class="w-5 h-5 flex items-center justify-center"><i data-lucide="message-circle" class="text-[#391B1B]" fill="currentColor"></i></div>
                <span class="font-bold text-[#391B1B]">카카오로 시작하기</span>
            </button>
            
            <div class="relative py-4">
                <div class="absolute inset-0 flex items-center">
                    <div class="w-full border-t border-gray-100"></div>
                </div>
                <div class="relative flex justify-center text-xs">
                    <span class="px-2 bg-white text-gray-400">또는 이메일로 로그인</span>
                </div>
            </div>

            <form id="form-login" class="space-y-4">
                <div>
                    <input id="input-email" type="email" placeholder="이메일 주소" class="w-full px-4 py-3 rounded-xl bg-gray-50 border-gray-100 border focus:border-black focus:bg-white focus:outline-none transition-colors text-sm" required>
                </div>
                <div>
                    <input id="input-password" type="password" placeholder="비밀번호" class="w-full px-4 py-3 rounded-xl bg-gray-50 border-gray-100 border focus:border-black focus:bg-white focus:outline-none transition-colors text-sm" required>
                </div>
                <button type="submit" id="btn-submit" class="w-full py-3.5 bg-black text-white rounded-xl font-bold hover:bg-gray-800 transition-colors shadow-lg shadow-gray-200 disabled:bg-gray-400">
                    로그인
                </button>
            </form>
        </div>
        
        <div class="mt-8 text-center text-xs text-gray-400">
            <a href="#" class="underline hover:text-black">아이디 찾기</a>
            <span class="mx-2">|</span>
            <a href="#" class="underline hover:text-black">비밀번호 찾기</a>
            <span class="mx-2">|</span>
            <a href="#" class="underline hover:text-black">회원가입</a>
        </div>
    </div>

    <script src="script.js"></script>
    
    <script>
        lucide.createIcons();

        // -----------------------------------------------------------
        // 아래 두 값을 본인의 Supabase 정보로 채워주세요!
        // -----------------------------------------------------------
        const SUPABASE_URL = 'https://ozhieovgrmnehaimuyni.supabase.co'; 
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im96aGllb3Zncm1uZWhhaW11eW5pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzgwODksImV4cCI6MjA4NDU1NDA4OX0.haULDDCnJXw4zwFeJSQKhS1Jun4CRFCziGgKQKVwmyY'; 

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        const btnGoogle = document.getElementById('btn-google');
        const btnKakao = document.getElementById('btn-kakao');
        const formLogin = document.getElementById('form-login');
        const btnSubmit = document.getElementById('btn-submit');

        async function handleSocialLogin(provider) {
            try {
                const { data, error } = await supabase.auth.signInWithOAuth({
                    provider: provider,
                    options: {
                        redirectTo: window.location.origin + '/index.html'
                    }
                });
                if (error) throw error;
            } catch (error) {
                alert(`로그인 오류: ${error.message}`);
            }
        }

        async function handleEmailLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('input-email').value;
            const password = document.getElementById('input-password').value;

            btnSubmit.disabled = true;
            btnSubmit.innerText = "로그인 중...";

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });

                if (error) throw error;

                localStorage.setItem('isLoggedIn', 'true');
                alert('환영합니다!');
                window.location.href = 'index.html';

            } catch (error) {
                alert(`로그인 실패: ${error.message}`);
                btnSubmit.disabled = false;
                btnSubmit.innerText = "로그인";
            }
        }

        btnGoogle.addEventListener('click', () => handleSocialLogin('google'));
        btnKakao.addEventListener('click', () => handleSocialLogin('kakao'));
        formLogin.addEventListener('submit', handleEmailLogin);

    </script>
</body>
</html>